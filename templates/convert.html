{% extends 'base.html' %}
{% block title %}Download{% endblock %}

{% block body %}
<main class="content-container">
    <div class="upload-area">
        <h1>File Conversion</h1>


        <div id="loading">‚è≥ Processing your file... please wait</div>

        <div id="downloads" style="display: none;">
            <p>Your file is ready to download!</p>
            <a href="{{ url_for('static', filename='uploads/response.txt')}}" 
               download="flashCard.csv" class="download-btn">
               Download Converted CSV file
            </a>
        </div>
    </div>
</main>

<script>
    function checkStatus() {
        fetch("/check_status")
            .then(res => res.json())
            .then(data => {
                if (data.ready) {
                    document.getElementById("loading").style.display = "none";
                    document.getElementById("downloads").style.display = "block";
                } else {
                    setTimeout(checkStatus, 2000); // try again in 2s
                }
            });
    }

    // Start polling when page loads
    window.onload = checkStatus;
</script>
{% endblock %}
